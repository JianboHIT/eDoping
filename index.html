<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="eDoping 学习分享" href="zintl.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.08.06 -->
        <title>eDoping 0.4.2 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">eDoping 0.4.2 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="#">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">相关文档</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="zintl.html">eDoping 学习分享</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/JianboHIT/eDoping" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="edoping">
<h1>eDoping 手册<a class="headerlink" href="#edoping" title="此标题的永久链接">¶</a></h1>
<p><strong>[切换语言:</strong> 简体中文 | <a class="reference external" href="en/index.html">English</a> <strong>]</strong> (下载 PDF 手册: <a class="reference download internal" download="" href="_downloads/f84d692445c9595bd7d86d993f591d72/eDoping_v0.4.2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">eDoping_v0.4.2.pdf</span></code></a>)</p>
<div class="toctree-wrapper compound">
</div>
<section id="id1">
<h2>主要功能<a class="headerlink" href="#id1" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>流程化带电点缺陷的形成能计算</p></li>
<li><p>完全基于命令行，无需编程和复杂的脚本</p></li>
<li><p>可以进行多组元体系的元素化学势估计</p></li>
<li><p>从 OQMD/MaterialsProject 快速获取竞争相结构和形成能</p></li>
<li><p>缺陷形成能的修正项计算</p></li>
<li><p>自洽费米能级的估计</p></li>
</ul>
</section>
<section id="id2">
<h2>程序安装<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h2>
<p>eDoping 程序包基于 <code class="docutils literal notranslate"><span class="pre">python3</span></code> 软件，确保它已经被正确安装。
如果可以联网，最简单的方式就是通过 <code class="docutils literal notranslate"><span class="pre">pip</span></code> 安装（或更新） eDoping 程序包:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>eDoping
</pre></div>
</div>
<p>如果无法联网或者对源代码感兴趣，程序包从 Github 下载，或者利用 <code class="docutils literal notranslate"><span class="pre">git</span></code> :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/JianboHIT/eDoping.git
</pre></div>
</div>
<p>对于中国大陆地区，也可以从 Gitee 获取源码，与上面类似：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://gitee.com/joulehit/eDoping.git
</pre></div>
</div>
<p>下载源码后，进入文件夹 (如果是压缩文件需要先解压缩) ，确保网络通畅,
我们可以通过 <code class="docutils literal notranslate"><span class="pre">pip</span></code> (或 <code class="docutils literal notranslate"><span class="pre">pip3</span></code>) 工具来自动安装程序以及所有依赖的库
(实际上只依赖于 numpy 和 sicpy):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>.
</pre></div>
</div>
<p>安装完成，我们就可以通过 <code class="docutils literal notranslate"><span class="pre">edp</span></code> 命令来使用 eDoping 程序包了。
通过 <code class="docutils literal notranslate"><span class="pre">-h</span></code> (或者 <code class="docutils literal notranslate"><span class="pre">--help</span></code>) 选项可以打印帮助信息，
同时检查安装是否成功：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ edp -h
usage: edp [-h] [-v] [-q] Subcommand ...

Point Defect Formation Energy Calculation - v0.4.0

options:
  -h, --help       show this help message and exit
  -v, --verbosity  increase output verbosity
  -q, --quiet      only show key output

Tips:
  Subcommand       Description
    cal            Calculate defect fromation energy
    energy         Read final energy from OUTCAR
    ewald          Read Ewald from OUTCAR
    volume         Read volume from OUTCAR
    epsilon        Read epsilon from OUTCAR
    evbm           Read VBM from EIGENVAL
    fixchg         Produce charge-fixed inputs
    boxhyd         Place a single hydrogen atom in the box
    refine         Refine the unit cell
    replace        Replace atoms X by Y
    groupby        Group atoms by radial distribution function
    diff           Show difference between two POSCAR
    query          Fetch data from OQMD website
    chempot        Calculate chemical potential
    trlevel        Calculate transition levels
    scfermi        Calculate sc-fermi level
    fzfermi        Calculate fz-fermi level

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Citation of EDOPING &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
If you have used EDOPING, please cite the following article:
 J. Zhu, J. Li, P. Liu, et al, eDoping: A high-throughput software
 package for evaluating point defect doping limits in semiconductor
 and insulator materials, Materials Today Physics, 55 (2025) 101754.
 DOI: 10.1016/j.mtphys.2025.101754
</pre></div>
</div>
<p>我们可以进一步查看子命令的帮助信息:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ edp replace -h
usage: edp replace [-h] [-p fa fb fc] [-i FILENAME] [-o FILENAME] X Y

positional arguments:
  X                     Name of previous atom
  Y                     Name of present atom

options:
  -h, --help            show this help message and exit
  -p fa fb fc, --position fa fb fc
                        Fractional coordinates of new interstitial atom
  -i FILENAME, --input FILENAME
                        Input filename(default: POSCAR)
  -o FILENAME, --output FILENAME
                        Output filename(default: POSCAR)
</pre></div>
</div>
<p>至此，我们就已经成功地安装了 eDoping 程序包。</p>
<p><strong>可选地:</strong> python 作为一种解释性编成语言，
因此每次运行都需要完全地加载相应的环境或者虚拟环境。
对于个人设备这是非常方便的，但是对于大型公共计算平台，
这就尤为不便了。一个解决办法就是将程序打包成独立可执行程序，
这样它就能和普通的程序一样不再依赖 python 环境。
我们程序开发之初就有考虑到这个问题，
因此严格控制对于第三方库的依赖，尽量以 python 的标准库来实现。
我们在程序源码包中，包含了一个 standalone 的文件夹，
其中包含一个 compile_for_linux.sh 脚本，
可以帮助我们完成独立可执行程序的构建。
这里，我们需要准备一个干净的 python 虚拟环境，
并安装 pyinstaller 和其它的 eDoping 依赖库,
然后运行下面的命令:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>standalone
$<span class="w"> </span>bash<span class="w"> </span>compile_for_linux.sh
</pre></div>
</div>
<p>当脚本运行成功后，
在 standalone/dist 中就得到了一个可执行程序 <code class="docutils literal notranslate"><span class="pre">edp</span></code>,
可以把它移动到任何需要的位置，方便日常工作。</p>
</section>
<section id="id3">
<h2>快速开始<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h2>
<p>确保已正确安装 eDoping 程序包（详细参考 <a class="reference internal" href="#id2">程序安装</a> 部分），
可以通过 <code class="docutils literal notranslate"><span class="pre">edp</span> <span class="pre">-h</span></code> 打印帮助信息。
密度泛函计算以 <code class="docutils literal notranslate"><span class="pre">VASP</span></code> 软件为例，理论上也可采用其它计算能量的软件，
但是目前的接口并未完全支持，有待后续完善。</p>
<section id="id4">
<h3>文件结构<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h3>
<p>以计算 NbFeSb 带有 Mn 和 Ni 间隙的缺陷为例（详见 Github/Gitee 仓库中的
<code class="docutils literal notranslate"><span class="pre">examples/</span></code>），这里我们推荐按照如下目录形式组织文件
（前置的编号方便 Tab 键快速补全）：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NbFeSb_Interstitials
├── 1.perfect
├── 2-1.defect-Mn_i
│   ├── charge_+1
│   ├── charge_+2
│   ├── charge_+3
│   ├── charge_-1
│   ├── charge_-2
│   ├── charge_-3
│   ├── charge_0
│   └── relax
├── 2-2.defect-Ni_i
│   ├── charge_+1
│   ├── charge_+2
│   ├── charge_+3
│   ├── charge_-1
│   ├── charge_-2
│   ├── charge_-3
│   ├── charge_0
│   └── relax
├── 3.phases
│   ├── NbFeSb_with_Mn
│   ├── NbFeSb_with_Ni
│   ├── elemental_Fe
│   ├── elemental_Mn
│   ├── elemental_Nb
│   ├── elemental_Ni
│   └── elemental_Sb
├── 4-1.corr-dielectric
├── 4-2.corr-hydrogen
├── EDOPING.Mn_i.in
└── EDOPING.Ni_i.in
</pre></div>
</div>
</section>
<section id="id5">
<h3>能量计算<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h3>
<p>这是缺陷计算的核心耗时部分，需要调用VASP软件计算得到完美晶胞和所有价态下缺陷胞的能量
（注意确保所有结构被合理驰豫至收敛），即 <code class="docutils literal notranslate"><span class="pre">1.perfect</span></code> 和 <code class="docutils literal notranslate"><span class="pre">2-X.defect-XX</span></code>
目录下所有的子文件夹。</p>
<p>为了模拟不同电荷量的缺陷，需要在 INCAR 文件中通过 NELECT 参数设置体系总电子数目。
为简化该过程，可以使用 <a class="reference internal" href="#cmdoption-arg-fixchg"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">fixchg</span></code></a> 命令从不带电的计算文件夹
自动生成带电缺陷的计算文件夹 <code class="docutils literal notranslate"><span class="pre">charge_+1</span></code> 、<code class="docutils literal notranslate"><span class="pre">charge_-1</span></code> 等：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>fixchg<span class="w"> </span>-i<span class="w"> </span>charge_0<span class="w"> </span>+1<span class="w"> </span>-1<span class="w"> </span>+2<span class="w"> </span>-2<span class="w"> </span>+3<span class="w"> </span>-3
</pre></div>
</div>
<p>这里 <code class="docutils literal notranslate"><span class="pre">charge_0</span></code> 中包含结构不带电时自洽计算所需的文件，
上述命令会完全复制该文件夹为 <code class="docutils literal notranslate"><span class="pre">charge_+1</span></code> 、 <code class="docutils literal notranslate"><span class="pre">charge_-1</span></code> 等文件夹，
并修改其中 INCAR 文件中的 NELECT 参数使其净电荷等于给定值。</p>
</section>
<section id="id6">
<h3>化学势计算<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h3>
<p>在缺陷形成能计算中，
原子化学势项用于表达缺陷晶胞与完美晶胞之间原子种类和数目不守恒导致的能量变化。
一种原子的化学势由两部分构成，即
<span class="math notranslate nohighlight">\(\mu_i = \mu _i^\Theta + \Delta \mu _i\)</span> ，
其中 <span class="math notranslate nohighlight">\(\mu _i^\Theta\)</span> 表示该元素单质中平均每个原子的能量，
这部分需要通过理论计算单质材料或者实验手段获得；
而对于 <span class="math notranslate nohighlight">\(\Delta \mu _i\)</span>，需要通过热力学稳定性条件获得其范围。
严格来说，我们需要计算所有潜在竞争相的形成能，
具体的竞争相通过查询数据库（比如 <a class="reference external" href="https://www.oqmd.org">OQMD</a> ，
<a class="reference external" href="https://next-gen.materialsproject.org">MaterialsProject</a> ，
<a class="reference external" href="https://aflowlib.org">AFLOW</a> 等）获得。</p>
<p>这里，我们提供了一个查询命令 <a class="reference internal" href="#cmdoption-arg-query"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">query</span></code></a> ，
可以直接从OQMD数据库获取所有竞争相的形成能（从 v0.4 开始支持 MaterialsProject
数据库，详见 <a class="reference internal" href="#cmdoption-arg-query"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">query</span></code></a> 介绍）。比如，对于含有 Mn 原子缺陷的 NbFeSb ，
可以通过如下命令获得 Ehull &lt; 0.01 eV/atom 的所有竞争相的形成能
（在 <code class="docutils literal notranslate"><span class="pre">3.phases/NbFeSb_with_Mn</span></code> 目录下运行）：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>query<span class="w"> </span>NbFeSb<span class="w"> </span>-x<span class="w"> </span>Mn<span class="w"> </span>--ehull<span class="w"> </span><span class="m">0</span>.01
</pre></div>
</div>
<p>结果保存在文件 <a class="reference internal" href="#edoping-cmpot">EDOPING.cmpot</a> 中。
这里如果省略 <code class="docutils literal notranslate"><span class="pre">--ehull</span></code> 选项，则会获取所有稳定和亚稳竞争相的能量。
此外，可以通过 <code class="docutils literal notranslate"><span class="pre">-s/--structure</span></code> 选项同时下载所有竞争相的结构文件
（POSCAR 格式），从而进行更加精准的能量计算：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>query<span class="w"> </span>NbFeSb<span class="w"> </span>-x<span class="w"> </span>Mn<span class="w"> </span>--ehull<span class="w"> </span><span class="m">0</span>.01<span class="w"> </span>--structure
</pre></div>
</div>
<p>然后根据计算的结果手动准备 <a class="reference internal" href="#edoping-cmpot">EDOPING.cmpot</a> 文件。
基于 <a class="reference internal" href="#edoping-cmpot">EDOPING.cmpot</a> 文件，就可以通过 <a class="reference internal" href="#cmdoption-arg-chempot"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">chempot</span></code></a>
命令根据化学环境确定元素的化学势：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>chempot<span class="w"> </span>-n
</pre></div>
</div>
<p>注意这里的 <code class="docutils literal notranslate"><span class="pre">-n</span></code> （或者 <code class="docutils literal notranslate"><span class="pre">--norm</span></code>）选项表示文件中的形成能单位是 eV/atom。
如果形成能是对应组分下的晶胞总能，则不需要该选项。
<a class="reference internal" href="#edoping-cmpot">EDOPING.cmpot</a> 文件会被自动读取，不同环境下的化学势
（<span class="math notranslate nohighlight">\(\Delta \mu _i\)</span>）会打印在屏幕上。</p>
</section>
<section id="id7">
<h3>修正项<a class="headerlink" href="#id7" title="此标题的永久链接">¶</a></h3>
<p>在点缺陷计算时，由于有限尺寸的限制通常需要对获得的形成能进行修正，即公式中的
<span class="math notranslate nohighlight">\(E_{corr}\)</span> 项。各种修正项中，镜像电荷修正需要额外提供介电常数和马德龙常数。
如果需要考虑该修正机制，可以通过下面的步骤通过 VASP 计算得到介电常数和马德龙常数。</p>
<p>在VASP中，针对完美结构的原始晶胞，可以参考下面的INCAR参数来获得介电常数
（参考 <code class="docutils literal notranslate"><span class="pre">4-1.corr-dielectric/INCAR</span></code>）：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Global</span> <span class="n">Parameters</span>
<span class="n">ISTART</span> <span class="o">=</span>  <span class="mi">0</span>            <span class="p">(</span><span class="n">Read</span> <span class="n">existing</span> <span class="n">wavefunction</span><span class="p">;</span> <span class="k">if</span> <span class="n">there</span><span class="p">)</span>
<span class="n">ISPIN</span>  <span class="o">=</span>  <span class="mi">1</span>            <span class="p">(</span><span class="n">Non</span><span class="o">-</span><span class="n">Spin</span> <span class="n">polarised</span> <span class="n">DFT</span><span class="p">)</span>
<span class="n">LREAL</span>  <span class="o">=</span> <span class="o">.</span><span class="n">FALSE</span><span class="o">.</span>       <span class="p">(</span><span class="n">Projection</span> <span class="n">operators</span><span class="p">:</span> <span class="n">automatic</span><span class="p">)</span>
<span class="n">ENCUT</span>  <span class="o">=</span>  <span class="mi">500</span>          <span class="p">(</span><span class="n">Cut</span><span class="o">-</span><span class="n">off</span> <span class="n">energy</span> <span class="k">for</span> <span class="n">plane</span> <span class="n">wave</span> <span class="n">basis</span> <span class="nb">set</span><span class="p">,</span> <span class="ow">in</span> <span class="n">eV</span><span class="p">)</span>
<span class="n">PREC</span>   <span class="o">=</span>  <span class="n">Accurate</span>     <span class="p">(</span><span class="n">Precision</span> <span class="n">level</span><span class="p">)</span>
<span class="n">LWAVE</span>  <span class="o">=</span> <span class="o">.</span><span class="n">FALSE</span><span class="o">.</span>       <span class="p">(</span><span class="n">Write</span> <span class="n">WAVECAR</span> <span class="ow">or</span> <span class="ow">not</span><span class="p">)</span>
<span class="n">LCHARG</span> <span class="o">=</span> <span class="o">.</span><span class="n">FALSE</span><span class="o">.</span>       <span class="p">(</span><span class="n">Write</span> <span class="n">CHGCAR</span> <span class="ow">or</span> <span class="ow">not</span><span class="p">)</span>

<span class="n">Static</span> <span class="n">Calculation</span>
<span class="n">NSW</span>    <span class="o">=</span> <span class="mi">1</span>
<span class="n">IBRION</span> <span class="o">=</span>  <span class="mi">8</span>
<span class="n">ISMEAR</span> <span class="o">=</span>  <span class="mi">0</span>            <span class="p">(</span><span class="n">gaussian</span> <span class="n">smearing</span> <span class="n">method</span><span class="p">)</span>
<span class="n">SIGMA</span>  <span class="o">=</span>  <span class="mf">0.01</span>         <span class="p">(</span><span class="n">please</span> <span class="n">check</span> <span class="n">the</span> <span class="n">width</span> <span class="n">of</span> <span class="n">the</span> <span class="n">smearing</span><span class="p">)</span>
<span class="n">NELM</span>   <span class="o">=</span>  <span class="mi">60</span>           <span class="p">(</span><span class="n">Max</span> <span class="n">electronic</span> <span class="n">SCF</span> <span class="n">steps</span><span class="p">)</span>
<span class="n">EDIFF</span>  <span class="o">=</span>  <span class="mf">1E-08</span>        <span class="p">(</span><span class="n">SCF</span> <span class="n">energy</span> <span class="n">convergence</span><span class="p">;</span> <span class="ow">in</span> <span class="n">eV</span><span class="p">)</span>

<span class="n">Macroscopic</span> <span class="n">Dielectric</span> <span class="n">Tensor</span>
<span class="n">LEPSILON</span> <span class="o">=</span> <span class="o">.</span><span class="n">TRUE</span><span class="o">.</span>
<span class="n">LPEAD</span> <span class="o">=</span> <span class="o">.</span><span class="n">TRUE</span><span class="o">.</span>
</pre></div>
</div>
<p>等待计算完成后，可以通过 <a class="reference internal" href="#cmdoption-arg-epsilon"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">epsilon</span></code></a> 命令打印 OUTCAR
文件中介电常数的信息：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ edp epsilon -f 4-1.corr-dielectric/OUTCAR
HEAD OF MICROSCOPIC STATIC DIELECTRIC TENSOR (INDEPENDENT PARTICLE, excluding Hartree and local field effects)
------------------------------------------------------
25.438394     0.000000    -0.000000
0.000000    25.438394     0.000000
-0.000000    -0.000000    25.438394
------------------------------------------------------

MACROSCOPIC STATIC DIELECTRIC TENSOR (including local field effects in DFT)
------------------------------------------------------
24.482055     0.000000    -0.000000
0.000000    24.482055    -0.000000
-0.000000     0.000000    24.482055
------------------------------------------------------

MACROSCOPIC STATIC DIELECTRIC TENSOR (including local field effects in DFT)
------------------------------------------------------
24.482055     0.000000    -0.000000
0.000000    24.482055    -0.000000
-0.000000     0.000000    24.482055
------------------------------------------------------

MACROSCOPIC STATIC DIELECTRIC TENSOR IONIC CONTRIBUTION
------------------------------------------------------
19.549608    -0.000000    -0.000000
-0.000000    19.549608     0.000000
-0.000000     0.000000    19.549608
------------------------------------------------------
</pre></div>
</div>
<p>从显示结果看到，离子贡献的介电常数为 19.55 （最后一个张量），电子贡献的介电常数为 24.48
（倒数第二个张量），因此总介电常数为 43.93。</p>
<p>对于马德隆常数，我们可以在和超胞同等尺寸的晶胞中放置一个单氢原子，VASP 自洽计算后
OUTCAR 文件中会包含相应的马德龙常数。这里提供了 <a class="reference internal" href="#cmdoption-arg-boxhyd"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">boxhyd</span></code></a>
命令从超胞 POSCAR 文件产生仅包含单氢原子的同尺寸 POSCAR 文件
（在 <code class="docutils literal notranslate"><span class="pre">4-2.corr-hydrogen</span></code> 目录下运行，其中包含超胞 POSCAR 文件）：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>boxhyd
</pre></div>
</div>
<p>运行后，得到 POSCAR.H 文件，对其进行自洽计算，通过 <a class="reference internal" href="#cmdoption-arg-ewald"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">ewald</span></code></a>
命令可以获得马德龙常数：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>ewald<span class="w"> </span>-f<span class="w"> </span><span class="m">4</span>-2.corr-hydrogen/OUTCAR
Final<span class="w"> </span><span class="o">(</span>absolute<span class="o">)</span><span class="w"> </span>Ewald:<span class="w"> </span><span class="m">1</span>.7152
</pre></div>
</div>
<p>即该超胞的马德隆常数为 1.7152。</p>
</section>
<section id="id8">
<h3>后处理<a class="headerlink" href="#id8" title="此标题的永久链接">¶</a></h3>
<p>根据前面的信息准备 <a class="reference internal" href="#edoping-in">EDOPING.in</a> 文件如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DPERFECT</span> <span class="o">=</span> <span class="mf">1.</span><span class="n">perfect</span>
<span class="n">DDEFECT</span>  <span class="o">=</span> <span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="n">defect</span><span class="o">-</span><span class="n">Mn_i</span>
<span class="n">CMPOT</span>    <span class="o">=</span> <span class="mi">0</span> <span class="o">-</span><span class="mf">9.0147</span>
<span class="n">VALENCE</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="c1"># PREFIX   = charge_</span>
<span class="c1"># DDNAME   = auto</span>
<span class="n">EVBM</span>     <span class="o">=</span> <span class="n">inf</span>
<span class="n">ECBM</span>     <span class="o">=</span> <span class="n">inf</span>
<span class="n">PENERGY</span>  <span class="o">=</span> <span class="n">inf</span>
<span class="n">PVOLUME</span>  <span class="o">=</span> <span class="n">inf</span>
<span class="n">EWALD</span>    <span class="o">=</span> <span class="mf">1.7152</span>
<span class="n">EPSILON</span>  <span class="o">=</span> <span class="mf">44.03</span>
<span class="n">BFTYPE</span>   <span class="o">=</span> <span class="mi">2</span>
<span class="n">EMIN</span>     <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">EMAX</span>     <span class="o">=</span> <span class="mi">2</span>
<span class="n">NPTS</span>     <span class="o">=</span> <span class="mi">3001</span>
</pre></div>
</div>
<p>然后调用 <a class="reference internal" href="#cmdoption-arg-cal"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">cal</span></code></a> 命令进行计算:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>cal<span class="w"> </span>-i<span class="w"> </span>EDOPING.in
</pre></div>
</div>
<p>运行结束后，会生成 <a class="reference internal" href="#edoping-log">EDOPING.log</a> 和 <a class="reference internal" href="#edoping-dat">EDOPING.dat</a> 文件，
分别记录了程序的运行日志和计算结果。</p>
</section>
</section>
<section id="id9">
<h2>点缺陷形成能计算<a class="headerlink" href="#id9" title="此标题的永久链接">¶</a></h2>
<p>在第一性原理的计算框架下，这里所有的计算都围绕能量 (或者也被称为焓值) 计算进行。
对于一个带电量为 <span class="math notranslate nohighlight">\(q\)</span> 的缺陷 <span class="math notranslate nohighlight">\(D\)</span> ，其形成能定义为：</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Delta H _{D} ^{q} (E _{F}) = E _{D} ^{q} - E _{perfect} - \sum _{i} {n _{i} \mu _{i}} + q E _{F} + E _{corr}\]</div>
</div>
<p>这里，<span class="math notranslate nohighlight">\(E_D^q\)</span> 表示带电量为 <span class="math notranslate nohighlight">\(q\)</span> 的缺陷 <span class="math notranslate nohighlight">\(D\)</span> 的超胞的能量，
<span class="math notranslate nohighlight">\(E_{perfect}\)</span> 表示对应的完美超胞的能量，
<span class="math notranslate nohighlight">\(\mu_i\)</span> 表示形成缺陷过程中失去 （ <span class="math notranslate nohighlight">\(n _{i} &lt; 0\)</span> ）
或者加入 (<span class="math notranslate nohighlight">\(n _{i} &gt; 0\)</span>) 的原子的化学势，
<span class="math notranslate nohighlight">\(n_i\)</span> 为对应的原子数量，
<span class="math notranslate nohighlight">\(E_F\)</span> 是实际缺陷体系的费米能级，
<span class="math notranslate nohighlight">\(E_{corr}\)</span> 是一些能量修正项，
比如来自于周期边界条件的影响、静电势的变化等等。
通常情况下，我们不能够准确定位体系费米能级的位置，
但是能够知道它位于带隙附近。因此，我们通常是给出
<span class="math notranslate nohighlight">\(\Delta H_D^q\)</span> - <span class="math notranslate nohighlight">\(E_F\)</span> 关系曲线，
因此这里我们将形成能表示为费米能级的函数。
接下来，我们将逐步解释其它每一项的计算，以及最终的数据处理过程。</p>
<section id="id10">
<h3>缺陷晶胞构建与体系能量计算<a class="headerlink" href="#id10" title="此标题的永久链接">¶</a></h3>
<p>完美晶胞的能量比较容易获得，因此我们这里将从缺陷结构的能量计算谈起。
我们首先考虑单一点缺陷的晶胞结构构建，包括空位、置换和间隙。
对于空位和间隙缺陷，通常我们可以直接手动修改 POSCAR 文件
获得缺陷结构，由于这个过程中我们不需要改变原子位置列表顺序。
对于取代缺陷，可以利用 <a class="reference internal" href="#cmdoption-arg-replace"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">replace</span></code></a> 从 POSCAR 文件来构建结构。
也可以借助一些晶体学可视化工具来辅助我们产生缺陷结构，
比如免费的 VESTA 软件。</p>
<p>当我们需要考虑更加复杂的缺陷时，可能的超胞结构构型数量将急剧增长，
利用结构的对称性我们能够有效减小所需的计算量。
对于比较简单的情况，我们可以利用结构可视化程序进行观察分析，
排除对称等价的结构，但是对于复杂的结构我们就很难处理了。
另外，专门处理这方面问题的软件和程序也非常有限。
在我们的软件中，集成了一个 <a class="reference internal" href="#cmdoption-arg-groupby"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">groupby</span></code></a> 命令，
可以用来辅助我们筛选出不等价的结构。
当我们需要在一个已包含缺陷的结构上需要再引入一个缺陷时，
我们舍弃了从传统的对称性来考虑等价性，
而是从近邻的环境进行分析，将具有相似环境的原子归为一组，
从而找出具有代表性的结构。由于点缺陷的局域特性，
近邻分析可能是一种更加直接有效的方式来确定候选复合缺陷构型的方式。</p>
<p>当缺陷结构构造好后，
我们可以通过 <a class="reference internal" href="#cmdoption-arg-diff"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">diff</span></code></a> 命令来对比原始的晶胞和当前晶胞的差异，
确保我们构造的构型是我们想要的。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<ul class="simple">
<li><p><a class="reference internal" href="#cmdoption-arg-replace"><code class="xref std std-option docutils literal notranslate"><span class="pre">replace</span></code></a> - 产生原子取代结构</p></li>
<li><p><a class="reference internal" href="#cmdoption-arg-groupby"><code class="xref std std-option docutils literal notranslate"><span class="pre">groupby</span></code></a> - 不等价原子位置分析</p></li>
<li><p><a class="reference internal" href="#cmdoption-arg-diff"><code class="xref std std-option docutils literal notranslate"><span class="pre">diff</span></code></a> - 晶体结构对比与分析</p></li>
</ul>
</div>
<p>当缺陷结构构建好后，我们将需要花费一定的时间来驰豫晶胞的结构，
从而获得收敛的能量值。而且，我们需要改变每种缺陷结构体系的电子数目，
来模拟不同的带电情况 （VASP 程序 INCAR 中的 NELECT 参数），得到相应的能量值。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<ul class="simple">
<li><p><a class="reference internal" href="#cmdoption-arg-fixchg"><code class="xref std std-option docutils literal notranslate"><span class="pre">fixchg</span></code></a> - 准备不同电荷数的计算文件</p></li>
</ul>
</div>
<p>对于 VASP 软件，如果结构优化/自洽计算正常结束，
我们可以通过 <code class="docutils literal notranslate"><span class="pre">grep</span></code> 命令配合 <code class="docutils literal notranslate"><span class="pre">tail</span></code> 命令从 OUTCAR 读取能量:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep &#39;energy  without entropy&#39; OUTCAR | tail -n 1
  energy  without entropy=     -755.64631647  energy(sigma-&gt;0) =     -755.65114440
</pre></div>
</div>
<p>这个例子中，体系的能量值为 -755.646 eV。
也可以通过 <a class="reference internal" href="#cmdoption-arg-energy"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">energy</span></code></a> 命令从 OUTCAR 文件中读取能量值。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<ul class="simple">
<li><p><a class="reference internal" href="#cmdoption-arg-energy"><code class="xref std std-option docutils literal notranslate"><span class="pre">energy</span></code></a> - 从 OUTCAR 读取体系能量值。</p></li>
</ul>
</div>
</section>
<section id="id11">
<h3>化学势计算与数据库使用<a class="headerlink" href="#id11" title="此标题的永久链接">¶</a></h3>
<p>在我们完成缺陷结构的构建和相关的计算后，
应该可以注意到一个重要的事情：
缺陷结构和相应的完美结构很难保持原子数目的守恒。
为了评估缺陷的形成能，我们就必须要消除原子本身的能量的差异，
也就是我们这里所说的化学势。
一个直接的想法是，我们可以用相应的单质材料计算来评估单个原子的能量。
然而事实却是，这是一种非常粗糙的评估，伴随有严重的系统误差。
我们可以想象，我们目标化合物中原子的能量，一定是低于单质中原子的能量，
否则我们的目标化合物将会分解成单质来降低系统的能量。
这里，一般将化合物中原子的能量称为化学势 <span class="math notranslate nohighlight">\(\mu_i\)</span>,
将单质中原子的能量称为标准化学势 <span class="math notranslate nohighlight">\(\mu _i^\Theta\)</span>,
然后有 <span class="math notranslate nohighlight">\(\mu_i = \mu _i^\Theta + \Delta \mu _i\)</span>,
这里我们的目标就是确定 <span class="math notranslate nohighlight">\(\Delta \mu _i\)</span> 的大小。
遗憾的是，目前没有办法来给出一个确切的 <span class="math notranslate nohighlight">\(\Delta \mu _i\)</span> 值，
我们能作的就是进行范围估计，
然后根据具体的实验环境进一步确定其值的大小。</p>
<p>按照我们前面的讨论，我们可以明确的知道一定有</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Delta \mu _i &lt; 0\]</div>
</div>
<p>另外一方面，按照能量守恒，
我们知道化合物中所有元素的内能改变量就是该化合物的形成焓
<span class="math notranslate nohighlight">\(\Delta H _{comp}\)</span>
也就是</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum _i {c_i \cdot \Delta \mu _i} = \Delta H _{comp}\]</div>
</div>
<p>这里，假设 <span class="math notranslate nohighlight">\(c_1 + c_2 + \ldots + c_N = 1\)</span>，
而且 <span class="math notranslate nohighlight">\(\Delta H _{comp}\)</span> 为平均每个原子的形成焓。
我们由此可以确定 <span class="math notranslate nohighlight">\(\Delta \mu _i\)</span> 的下边界：</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[c_i \cdot \Delta \mu _i &gt; \Delta H _{comp}\]</div>
</div>
<p>在实验中，称 <span class="math notranslate nohighlight">\(\Delta \mu _i = 0\)</span> 时的 <span class="math notranslate nohighlight">\(\mu _i\)</span>
为 “rich”, 称 <span class="math notranslate nohighlight">\(\Delta \mu _i = \Delta H _{comp} / c _i\)</span>
时的 <span class="math notranslate nohighlight">\(\mu _i\)</span> 为 “poor”。</p>
<p>对于二元化合物，我们不难注意到，当一种元子的化学势为 “rich” 时，
另外一种原子的化学势必然为 “poor”。
因此，我们通常会给出两种原子分别为 “rich” 的情况来计算缺陷形成能，
反映了化学环境从一个极端到另外一个极端的情况，
真实的实验情况必然介于这两个极限情况之间。</p>
<p>随着元素种类增加到三种时, “poor” 和 “rich” 的概念就比较复杂了，
因为当一种原子为 “rich” 时，另外两种原子的情况我们并不能确定，
我们不得不进行细致的分类讨论，从而尽可能的接近实验环境。</p>
<p>尽管如此，这个范围依然太粗糙了。
目前，最有效的进一步缩小化学势范围的办法就是考虑加入竞争相的考虑。
按照我们前面的分析不难想到，
目标化合物中各原子的化学势之和必然小于竞争性的形成焓，
否则实验中就应该是形成更 “稳定” 的竞争相而不我们的目标相。
由此我们可以引入一系列的不等式约束:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum _i {c _{j,i} \cdot \Delta \mu _{j,i}} \leq \Delta H _{comp,j}\]</div>
</div>
<p>这里的角标 <span class="math notranslate nohighlight">\(j\)</span> 表示第 <span class="math notranslate nohighlight">\(j\)</span> 竞争相。
在这一系列的不等式约束下，化学势的范围会更加精细，
可行域的形状也变得更加复杂。</p>
<p>在我们的程序设计中，摈弃了对可行域形状的讨论，
而是将注意力直接放在了每种元素的化学势取值范围上。
尤其对于多组元化合物，当元素种类为 N 时，
其可行域的维度为 N-1 ，由于第二相对可行域的裁剪，
使其形状变得及其复杂。
此时我们没有精力去关注所有顶角的情况，
而且希望直接地知道某种关心元素的化学势范围。
我们的程序正是为此开发了 <a class="reference internal" href="#cmdoption-arg-chempot"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">chempot</span></code></a> 命令，
来直接地获取不同元素的化学势取值范围。</p>
<p>手动处理大量竞争相是一个费力耗时的过程，
因此我们提供了 <a class="reference internal" href="#cmdoption-arg-query"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">query</span></code></a> 命令来，
能够从数据库直接获取所有竞争相结构文件。
同时，我们还可以从数据库同时拉取竞争相的形成焓,
方便我们检查自己的计算结果。
另外一方面，在第一性原理的计算框架下，
体系的能量值是依赖于赝势和计算程序的，
但是物质的形成焓具有较好的稳定性。
当我们对精度的要求不高时，或者进行初步试探时，
我们完全可以利用数据库的竞争相形成焓来确定元素化学势的范围，
加速我们的工作进程。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<ul class="simple">
<li><p><a class="reference internal" href="#cmdoption-arg-chempot"><code class="xref std std-option docutils literal notranslate"><span class="pre">chempot</span></code></a> - 根据化合物和竞争相形成焓估计原子的化学势</p></li>
<li><p><a class="reference internal" href="#cmdoption-arg-query"><code class="xref std std-option docutils literal notranslate"><span class="pre">query</span></code></a> - 从数据库获取竞争相结构和形成焓</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>由于数据库的高通量计算缘故，形成焓精度非常有限，
因此只建议作为初步探索使用，
我们无法对数据库获取到的数据可靠性作任何保证。
此外，此功能的开发主要是为了方便大家交流学习，
如有任何侵权行为，我们会立即关停此功能。</p>
</div>
</section>
</section>
<section id="id12">
<h2>命令行使用参考<a class="headerlink" href="#id12" title="此标题的永久链接">¶</a></h2>
<p>我们可以通过 <code class="docutils literal notranslate"><span class="pre">edp</span> <span class="pre">-h</span></code> 来查看所有支持的命令，
一般命令的使用格式为：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span><span class="o">[</span>-v<span class="p">|</span>-q<span class="o">]</span><span class="w"> </span>&lt;command&gt;<span class="w"> </span>--option1<span class="w"> </span>--option2<span class="w"> </span><span class="o">[</span>inputfile<span class="o">]</span>
</pre></div>
</div>
<p>这里的 <code class="docutils literal notranslate"><span class="pre">-v</span></code> 选项可以增加屏幕的显示信息，
而 <code class="docutils literal notranslate"><span class="pre">-q</span></code> 选项会尽量抑制屏幕的显示信息。
我们可以通过子命令的 <code class="docutils literal notranslate"><span class="pre">-h</span></code> 选项来查看支持的操作，
比如查看 <a class="reference internal" href="#cmdoption-arg-chempot"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">chempot</span></code></a> 命令支持的选项：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>chempot<span class="w"> </span>-h
</pre></div>
</div>
<p>接下来我们将介绍支持的子命令 (以字母表顺序排序):</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-boxhyd">
<span class="sig-name descname"><span class="pre">boxhyd</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-boxhyd" title="永久链接至目标">¶</a></dt>
<dd><p>产生仅包含单氢原子的同尺寸 POSCAR 文件。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-cal">
<span class="sig-name descname"><span class="pre">cal</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-cal" title="永久链接至目标">¶</a></dt>
<dd><p>根据配置文件（由 <code class="docutils literal notranslate"><span class="pre">-i/--input</span></code> 选项指定, 默认为 <a class="reference internal" href="#edoping-in">EDOPING.in</a>）
计算缺陷形成能随费米能级的变化。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-chempot">
<span class="sig-name descname"><span class="pre">chempot</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-chempot" title="永久链接至目标">¶</a></dt>
<dd><p>求解元素化学势的范围</p>
<p>这里我们需要准备一个输入文件 (默认文件名为 <a class="reference internal" href="#edoping-cmpot">EDOPING.cmpot</a>),
第一行需要以 ‘#’ 号开始, 然后依次是每种元素的名称，
以空格分隔。接下来是所有考虑的化合物的元素配比，
以及相应的能量值。
这里，第一个出现的化合物 (也就是文件的第二行)
会被程序认定为目标化合物，也就是我们的基体相物质。</p>
<p><strong>重要提醒</strong>: 在处理元素配比和能量时，
由于个人习惯以及不同数据库的格式规范差异，
我们需要非常小心这里的归一化相关的问题:</p>
<ul class="simple">
<li><p>元素配比格式: (1) 晶胞中每种原子数目 (2) 最简原子数比 (3) 归一化比例</p></li>
<li><p>化合物的焓值表示: (A) 晶胞的总焓值 (B) 平均每个原子的焓值</p></li>
<li><p>焓值的参考: (I) 绝对焓值，即计算程序中给出的焓值
(II) 形成焓，即相对与对应单质的焓值差</p></li>
</ul>
<p>在程序内部，我们实际上是在处理类似下面的式子:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\frac{1}{C} \sum _{i} {c _{i} \cdot \mu _{i}} \le \mu\]</div>
</div>
<p>这里，<span class="math notranslate nohighlight">\(i\)</span> 代指不同的化合物，
<span class="math notranslate nohighlight">\(c_i\)</span> 是输入文件的元素配比，
<span class="math notranslate nohighlight">\(\mu\)</span> 是输入文件的化合物焓值；
如果使用了 <code class="docutils literal notranslate"><span class="pre">-n</span></code> (<code class="docutils literal notranslate"><span class="pre">--norm</span></code>) 选项，则
<span class="math notranslate nohighlight">\(C = \sum _i c_i\)</span>，否则 <span class="math notranslate nohighlight">\(C=1\)</span>。
简单来说，为了得到正确的结果，
对于 (1+B) 和 (2+B) 情况需要指定 <code class="docutils literal notranslate"><span class="pre">-n</span></code> (<code class="docutils literal notranslate"><span class="pre">--norm</span></code>) 选项，
而对于 (1+A) 和 (3+B) 情况则需要避免该选项。
由于缺少必要的信息，我们无法处理 (2+A) 和 (3+A) 的情况，
需要使用者进行必要的数据处理。</p>
<p>至于焓值的参考问题，基本原则就是：
最终求解化学势的参考就是初始给定化合物焓值的参考。
如果提供的都是 (I) 绝对的焓值，那么给出的就是绝对化学势；
如果提供的都是 (II) 形成焓，那么给出的元素化学势和对应单质的差值。</p>
<p>由于 <a class="reference internal" href="#edoping-in">EDOPING.in</a> 文件需要指定绝对化学势，为了简化计算流程，
可以通过 <code class="docutils literal notranslate"><span class="pre">--refs</span></code> 选项指定每个单质元素的标准化学势，
从而最终获得相应的绝对化学势。在程序内部，
实际上就是将最后求解的化学势数值加上该参考值。</p>
<div class="versionadded">
<p><span class="versionmodified added">在 0.3 版本加入: </span><code class="docutils literal notranslate"><span class="pre">--refs</span></code> 选项。</p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-diff">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-diff" title="永久链接至目标">¶</a></dt>
<dd><p>对比两个具有相同基矢 POSCAR 的原子增减情况，可以用于检查点缺陷。
以含有 Mn 间隙的 NbFeSb 超胞为例，结果如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd examples/NbFeSb_Interstitials
$ edp diff 1.perfect/POSCAR 2-1.defect-Mn_i/relax/POSCAR
  No.    f_a     f_b     f_c     previous    present
 i 1     0.1250  0.1250  0.1250   Vac1         Mn1
</pre></div>
</div>
<p>这里，<code class="docutils literal notranslate"><span class="pre">i</span></code> 表示间隙型缺陷（<code class="docutils literal notranslate"><span class="pre">v</span></code> 表示空位，<code class="docutils literal notranslate"><span class="pre">s</span></code> 表示取代）。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-energy">
<span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-energy" title="永久链接至目标">¶</a></dt>
<dd><p>从 OUTCAR 文件读取最后一步的能量。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-epsilon">
<span class="sig-name descname"><span class="pre">epsilon</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-epsilon" title="永久链接至目标">¶</a></dt>
<dd><p>从 OUTCAR 文件读取并打印各项介电常数。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-ewald">
<span class="sig-name descname"><span class="pre">ewald</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-ewald" title="永久链接至目标">¶</a></dt>
<dd><p>从 OUTCAR 文件读取并打印马德龙常数。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-fixchg">
<span class="sig-name descname"><span class="pre">fixchg</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-fixchg" title="永久链接至目标">¶</a></dt>
<dd><p>自动生成带电缺陷的计算文件夹，通过 <code class="docutils literal notranslate"><span class="pre">-i/--inputdir</span></code>
选项指定不带电结构自洽计算的文件夹（默认为 <code class="docutils literal notranslate"><span class="pre">charge_0</span></code>）。这里实际上会从
POTCAR 文件计算体系的净电子数，然后根据给定的体系电荷量自动计算体系的电子数
（NELECT 参数）。因此，推荐在准备好不带电结构的计算文件夹后，
运行该命令生成带电缺陷的计算文件夹，然后再进行批量提交。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-groupby">
<span class="sig-name descname"><span class="pre">groupby</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-groupby" title="永久链接至目标">¶</a></dt>
<dd><p>利用径向分布函数对 POSCAR 中的原子进行分组，可以用于寻找不等价位置的复合缺陷。
比如，我们想在含有 Mn 间隙缺陷的 NbFeSb 超胞中再引入一个 Fe 空位。
在超胞中通常有很多个 Fe 原子，逐个计算每个位点的情况是非常耗时的。
一个有效的简化策略就是，按照每个 Fe 原子的近邻环境对它们进行分组，
对于同一个组内的 Fe 原子，它们理应具有相似的缺陷行为。如下所示，
POSCAR 是一个包含 Mn 间隙原子的 NbFeSb 超胞：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd examples/NbFeSb_Interstitials/2-1.defect-Mn_i/relax/
$ edp groupby -f POSCAR Fe
Group #1: Fe1, Fe2, Fe9, Fe11, Fe17, Fe21
Group #2: Fe3, Fe4, Fe5, Fe6, Fe10, Fe12, Fe13, Fe15, Fe18, Fe19, Fe22, Fe23
Group #3: Fe7, Fe8, Fe14, Fe16, Fe20, Fe24
Group #4: Fe25, Fe26, Fe27, Fe28, Fe29, Fe30, Fe31, Fe32

===============================================================================
No.|     Group #1     |     Group #2     |     Group #3     |     Group #4
---+------------------+------------------+------------------+------------------
 0 |  (0.0, &#39;Fe&#39;, 1)  |  (0.0, &#39;Fe&#39;, 1)  |  (0.0, &#39;Fe&#39;, 1)  |  (0.0, &#39;Fe&#39;, 1)
 1 |  (2.6, &#39;Nb&#39;, 4)  |  (2.6, &#39;Nb&#39;, 4)  |  (2.6, &#39;Nb&#39;, 4)  |  (2.6, &#39;Nb&#39;, 4)
 2 |  (2.6, &#39;Sb&#39;, 4)  |  (2.6, &#39;Sb&#39;, 4)  |  (2.6, &#39;Sb&#39;, 4)  |  (2.6, &#39;Sb&#39;, 4)
 3 |  (3.0, &#39;Mn&#39;, 1)  | (4.2, &#39;Fe&#39;, 12)  | (4.2, &#39;Fe&#39;, 12)  | (4.2, &#39;Fe&#39;, 12)
 4 | (4.2, &#39;Fe&#39;, 12)  | (4.9, &#39;Nb&#39;, 12)  | (4.9, &#39;Nb&#39;, 12)  | (4.9, &#39;Nb&#39;, 12)
 5 | (4.9, &#39;Nb&#39;, 12)  | (4.9, &#39;Sb&#39;, 12)  | (4.9, &#39;Sb&#39;, 12)  | (4.9, &#39;Sb&#39;, 12)
 6 | (4.9, &#39;Sb&#39;, 12)  |  (6.0, &#39;Fe&#39;, 6)  |  (6.0, &#39;Fe&#39;, 6)  |  (5.2, &#39;Mn&#39;, 1)
 7 |  (6.0, &#39;Fe&#39;, 6)  | (6.5, &#39;Nb&#39;, 12)  | (6.5, &#39;Nb&#39;, 12)  |  (6.0, &#39;Fe&#39;, 6)
 8 | (6.5, &#39;Nb&#39;, 12)  | (6.5, &#39;Sb&#39;, 12)  | (6.5, &#39;Sb&#39;, 12)  | (6.5, &#39;Nb&#39;, 12)
 9 | (6.5, &#39;Sb&#39;, 12)  |  (6.7, &#39;Mn&#39;, 2)  | (7.3, &#39;Fe&#39;, 24)  | (6.5, &#39;Sb&#39;, 12)
10 | (7.3, &#39;Fe&#39;, 24)  | (7.3, &#39;Fe&#39;, 24)  | (7.7, &#39;Nb&#39;, 16)  | (7.3, &#39;Fe&#39;, 24)
11 | (7.7, &#39;Nb&#39;, 16)  | (7.7, &#39;Nb&#39;, 16)  | (7.7, &#39;Sb&#39;, 16)  | (7.7, &#39;Nb&#39;, 16)
12 | (7.7, &#39;Sb&#39;, 16)  | (7.7, &#39;Sb&#39;, 16)  | (8.4, &#39;Fe&#39;, 12)  | (7.7, &#39;Sb&#39;, 16)
13 | (8.4, &#39;Fe&#39;, 12)  | (8.4, &#39;Fe&#39;, 12)  | (8.8, &#39;Nb&#39;, 24)  | (8.4, &#39;Fe&#39;, 12)
14 | (8.8, &#39;Nb&#39;, 24)  | (8.8, &#39;Nb&#39;, 24)  | (8.8, &#39;Sb&#39;, 24)  | (8.8, &#39;Nb&#39;, 24)
15 | (8.8, &#39;Sb&#39;, 24)  | (8.8, &#39;Sb&#39;, 24)  |  (8.9, &#39;Mn&#39;, 4)  | (8.8, &#39;Sb&#39;, 24)
16 |  (8.9, &#39;Mn&#39;, 1)  | (9.4, &#39;Fe&#39;, 24)  | (9.4, &#39;Fe&#39;, 24)  | (9.4, &#39;Fe&#39;, 24)
17 | (9.4, &#39;Fe&#39;, 24)  | (9.8, &#39;Nb&#39;, 12)  | (9.8, &#39;Nb&#39;, 12)  | (9.8, &#39;Nb&#39;, 12)
18 | (9.8, &#39;Nb&#39;, 12)  | (9.8, &#39;Sb&#39;, 12)  | (9.8, &#39;Sb&#39;, 12)  | (9.8, &#39;Sb&#39;, 12)
19 | (9.8, &#39;Sb&#39;, 12)  | (10.3, &#39;Fe&#39;, 8)  | (10.3, &#39;Fe&#39;, 8)  |  (9.9, &#39;Mn&#39;, 3)
20 | (10.3, &#39;Fe&#39;, 8)  | (10.6, &#39;Nb&#39;, 24) | (10.6, &#39;Nb&#39;, 24) | (10.3, &#39;Fe&#39;, 8)
21 | (10.6, &#39;Nb&#39;, 24) | (10.6, &#39;Sb&#39;, 24) | (10.6, &#39;Sb&#39;, 24) | (10.6, &#39;Nb&#39;, 24)
22 | (10.6, &#39;Sb&#39;, 24) | (10.7, &#39;Mn&#39;, 2)  | (11.1, &#39;Fe&#39;, 48) | (10.6, &#39;Sb&#39;, 24)
23 | (11.1, &#39;Fe&#39;, 48) | (11.1, &#39;Fe&#39;, 48) | (11.4, &#39;Nb&#39;, 36) | (11.1, &#39;Fe&#39;, 48)
24 | (11.4, &#39;Nb&#39;, 36) | (11.4, &#39;Nb&#39;, 36) | (11.4, &#39;Sb&#39;, 36) | (11.4, &#39;Nb&#39;, 36)
25 | (11.4, &#39;Sb&#39;, 36) | (11.4, &#39;Sb&#39;, 36) | (11.9, &#39;Fe&#39;, 6)  | (11.4, &#39;Sb&#39;, 36)
26 | (11.9, &#39;Fe&#39;, 6)  | (11.9, &#39;Fe&#39;, 6)  | (12.2, &#39;Nb&#39;, 12) | (11.9, &#39;Fe&#39;, 6)
27 | (12.2, &#39;Nb&#39;, 12) | (12.2, &#39;Nb&#39;, 12) | (12.2, &#39;Sb&#39;, 12) | (12.2, &#39;Nb&#39;, 12)
28 | (12.2, &#39;Sb&#39;, 12) | (12.2, &#39;Sb&#39;, 12) | (12.3, &#39;Mn&#39;, 4)  | (12.2, &#39;Sb&#39;, 12)
29 | (12.3, &#39;Mn&#39;, 4)  | (12.6, &#39;Fe&#39;, 36) | (12.6, &#39;Fe&#39;, 36) | (12.6, &#39;Fe&#39;, 36)
30 | (12.6, &#39;Fe&#39;, 36) | (12.9, &#39;Nb&#39;, 28) | (12.9, &#39;Nb&#39;, 28) | (12.9, &#39;Nb&#39;, 28)
===============================================================================
</pre></div>
</div>
<p>可以看到，32 个 Fe 原子可以被分成 4 组。元组内的三项分别是距离、原子类别和数量。
比如， Fe1, Fe2, Fe9, Fe11, Fe17, Fe21 都属于组 #1，
它们在 12.6 Angstrom 范围内具有着完全相同近邻原子。
具体地，它们与最近的一个 Mn 原子距离 3.0 Angstrom，与第二近邻的 Mn 原子距离
8.9 Angstrom。为了更加清晰地聚焦于 Mn 原子，可以使用 <code class="docutils literal notranslate"><span class="pre">--grep</span> <span class="pre">Mn</span></code>
选项只保留含有 Mn 原子的行：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ edp groupby -f POSCAR Fe --grep Mn
Group #1: Fe1, Fe2, Fe9, Fe11, Fe17, Fe21
Group #2: Fe3, Fe4, Fe5, Fe6, Fe10, Fe12, Fe13, Fe15, Fe18, Fe19, Fe22, Fe23
Group #3: Fe7, Fe8, Fe14, Fe16, Fe20, Fe24
Group #4: Fe25, Fe26, Fe27, Fe28, Fe29, Fe30, Fe31, Fe32

===============================================================================
No.|     Group #1     |     Group #2     |     Group #3     |     Group #4
---+------------------+------------------+------------------+------------------
 3 |  (3.0, &#39;Mn&#39;, 1)  | (4.2, &#39;Fe&#39;, 12)  | (4.2, &#39;Fe&#39;, 12)  | (4.2, &#39;Fe&#39;, 12)
 6 | (4.9, &#39;Sb&#39;, 12)  |  (6.0, &#39;Fe&#39;, 6)  |  (6.0, &#39;Fe&#39;, 6)  |  (5.2, &#39;Mn&#39;, 1)
 9 | (6.5, &#39;Sb&#39;, 12)  |  (6.7, &#39;Mn&#39;, 2)  | (7.3, &#39;Fe&#39;, 24)  | (6.5, &#39;Sb&#39;, 12)
15 | (8.8, &#39;Sb&#39;, 24)  | (8.8, &#39;Sb&#39;, 24)  |  (8.9, &#39;Mn&#39;, 4)  | (8.8, &#39;Sb&#39;, 24)
16 |  (8.9, &#39;Mn&#39;, 1)  | (9.4, &#39;Fe&#39;, 24)  | (9.4, &#39;Fe&#39;, 24)  | (9.4, &#39;Fe&#39;, 24)
19 | (9.8, &#39;Sb&#39;, 12)  | (10.3, &#39;Fe&#39;, 8)  | (10.3, &#39;Fe&#39;, 8)  |  (9.9, &#39;Mn&#39;, 3)
22 | (10.6, &#39;Sb&#39;, 24) | (10.7, &#39;Mn&#39;, 2)  | (11.1, &#39;Fe&#39;, 48) | (10.6, &#39;Sb&#39;, 24)
28 | (12.2, &#39;Sb&#39;, 12) | (12.2, &#39;Sb&#39;, 12) | (12.3, &#39;Mn&#39;, 4)  | (12.2, &#39;Sb&#39;, 12)
29 | (12.3, &#39;Mn&#39;, 4)  | (12.6, &#39;Fe&#39;, 36) | (12.6, &#39;Fe&#39;, 36) | (12.6, &#39;Fe&#39;, 36)
===============================================================================
</pre></div>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-query" title="永久链接至目标">¶</a></dt>
<dd><p>从公开材料数据库获取竞争相信息。通过 <code class="docutils literal notranslate"><span class="pre">--backend</span></code> 选项指定数据库的名称：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OQMD</span></code> (默认值): The Open Quantum Materials Database (<a class="reference external" href="https://www.oqmd.org">https://www.oqmd.org</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MP</span></code> : The Materials Project (<a class="reference external" href="https://next-gen.materialsproject.org">https://next-gen.materialsproject.org</a>)</p></li>
</ul>
<p>通过该命令我们可以得到用于化学势估计的输入数据文件 <a class="reference internal" href="#edoping-cmpot">EDOPING.cmpot</a> ,
其中给定的最简原子比和化合物平均每个原子的形成焓。因此，
为了得到正确的化学势 <span class="math notranslate nohighlight">\(\Delta \mu_i\)</span>，
在使用 <a class="reference internal" href="#cmdoption-arg-chempot"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">chempot</span></code></a> 进行计算时需要添加
<code class="docutils literal notranslate"><span class="pre">-n</span></code> (<code class="docutils literal notranslate"><span class="pre">--norm</span></code>) 选项。</p>
<div class="admonition hint">
<p class="admonition-title">提示</p>
<p>使用 Materials Project 数据库前必须正确配置 <code class="docutils literal notranslate"><span class="pre">MP_API_KEY</span></code> 环境变量（在
<a class="reference external" href="https://next-gen.materialsproject.org/api">Materials Project - API 页面</a>
注册并获取 API key），将下面命令中的 <code class="docutils literal notranslate"><span class="pre">&lt;your_api_key&gt;</span></code> 替换为你的 API key：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">MP_API_KEY</span><span class="o">=</span>&lt;your_api_key&gt;
</pre></div>
</div>
<p>对于私有化平台，可以将其添加到 <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> 文件中避免反复配置。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>使用时确保网络畅通，且受制于数据库的访问频率限制，
不建议在短时间内反复多次使用。
通常情况下，可以先到数据库官网进行查询，
具有更好的可视化结果，然后再通过该命令进行数据获取。</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 0.4 版本加入: </span>支持 Materials Project 后端数据库。</p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-refine">
<span class="sig-name descname"><span class="pre">refine</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-refine" title="永久链接至目标">¶</a></dt>
<dd><p>对晶体结构进行调整，目前支持的操作如下：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">-t/--transform</span></code>: 根据给定的变换矩阵进行扩胞。变换矩阵通常是一个 3x3
的整数矩阵，输入时 9 个组元以空格分隔排列成一行，比如 <code class="docutils literal notranslate"><span class="pre">-t</span> <span class="pre">&quot;2</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">2</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">2&quot;</span></code> 。
该选项也支持 3 个元素和 1 个元素的格式，分别表示对角矩阵和缩放的单位矩阵。
下面的三条命令是等价的：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>refine<span class="w"> </span>-t<span class="w"> </span><span class="s2">&quot;2 0 0 0 2 0 0 0 2&quot;</span>
$<span class="w"> </span>edp<span class="w"> </span>refine<span class="w"> </span>-t<span class="w"> </span><span class="s2">&quot;2 2 2&quot;</span>
$<span class="w"> </span>edp<span class="w"> </span>refine<span class="w"> </span>-t<span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<p>此外，如果不提供值，软件会尝试从当前目录下的 <code class="docutils literal notranslate"><span class="pre">TRANSMAT.in</span></code> 文件读取变换矩阵
（兼容 <a class="reference external" href="https://vaspkit.com/">vaspkit</a> 软件格式）：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>refine<span class="w"> </span>-t
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>eDoping 软件内部使用行向量矩阵的表示晶胞基矢，这与 VASP、Quantum Espresso、
vaspkit 等软件保持一致，但是与 VESTA、phonopy 等软件采用的列向量形式不同。
它们的转变矩阵相差一个转置操作。</p>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">-c/--cubicize</span></code>: 在给定的原子数附近进行立方体扩胞。比如：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>refine<span class="w"> </span>-c<span class="w"> </span><span class="m">100</span>
</pre></div>
</div>
<p>这表示寻找原子数靠近 100 且最接近立方体的超胞。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">-d/--displace</span></code>: 移动晶胞中的原子。通常需要提供四个参数，
依次表示需要移动的原子索引，沿着笛卡尔坐标系 x/y/z 方向的位移量
（以埃为单位，注意：<strong>不是分数坐标</strong>）。比如：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>refine<span class="w"> </span>-d<span class="w"> </span>Sb3<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.1
</pre></div>
</div>
<p>这表示将第 3 个 Sb 原子沿着 z 方向移动 0.1 埃。</p>
</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">在 0.4 版本加入: </span>支持 <code class="docutils literal notranslate"><span class="pre">refine</span></code> 命令。</p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-replace" title="永久链接至目标">¶</a></dt>
<dd><p>替换 POSCAR 文件中的原子。通常需要两个位置变量以此表示旧的原子和新的原子。
特别地，当新原子指定为 <code class="docutils literal notranslate"><span class="pre">Vac</span></code> 时表示删除原子，构造空位缺陷；
当旧原子指定为 <code class="docutils literal notranslate"><span class="pre">Vac</span></code> 时表示仅插入原子，构造间隙缺陷。
构造间隙缺陷时，必须通过 <code class="docutils literal notranslate"><span class="pre">-p/--position</span></code> 选项指定间隙原子的位置。</p>
<p>例子1：将 POSCAR 中的 Fe2 替换为 Co，并将新结构保存为 POSCAR-sub ：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>replace<span class="w"> </span>-o<span class="w"> </span>POSCAR-sub<span class="w"> </span>Fe2<span class="w"> </span>Co
</pre></div>
</div>
<p>例子2：在 POSCAR 中构建 Fe2 位置的空位缺陷，并将新结构保存为 POSCAR-vac ：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>replace<span class="w"> </span>-o<span class="w"> </span>POSCAR-vac<span class="w"> </span>Fe2<span class="w"> </span>Vac
</pre></div>
</div>
<p>例子3：在 POSCAR 中 (0.125, 0.125, 0.125) 处插入 Co 间隙原子，并将新结构保存为 POSCAR-int ：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>replace<span class="w"> </span>-o<span class="w"> </span>POSCAR-int<span class="w"> </span>Vac<span class="w"> </span>Co<span class="w"> </span>-p<span class="w"> </span><span class="m">0</span>.125<span class="w"> </span><span class="m">0</span>.125<span class="w"> </span><span class="m">0</span>.125
</pre></div>
</div>
<p>可以通过 <a class="reference internal" href="#cmdoption-arg-diff"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">diff</span></code></a> 检查 POSCAR 文件的变化：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>edp<span class="w"> </span>diff<span class="w"> </span>POSCAR<span class="w"> </span>POSCAR-int
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 0.3 版本加入: </span>支持通过 <code class="docutils literal notranslate"><span class="pre">Vac</span></code> 字符构造空位缺陷和间隙缺陷。</p>
</div>
</dd></dl>

</section>
<section id="id13">
<h2>输入/输出文件<a class="headerlink" href="#id13" title="此标题的永久链接">¶</a></h2>
<section id="edoping-in">
<h3>EDOPING.in<a class="headerlink" href="#edoping-in" title="此标题的永久链接">¶</a></h3>
<p>这是 <a class="reference internal" href="#cmdoption-arg-cal"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">cal</span></code></a> 命令的输入文件，用于指定点实施缺陷计算的一些配置。
关键字推荐使用大写字母（大小写不敏感特性还在实验中）。<code class="docutils literal notranslate"><span class="pre">#</span></code> 号开头的行是注释行，
会被程序忽略。行内的 <code class="docutils literal notranslate"><span class="pre">#</span></code> 号之后的内容也会被忽略。</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-DPERFECT">
<span class="sig-name descname"><span class="pre">DPERFECT</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-DPERFECT" title="永久链接至目标">¶</a></dt>
<dd><p>完美基体超胞自洽计算的目录路径。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-DDEFECT">
<span class="sig-name descname"><span class="pre">DDEFECT</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-DDEFECT" title="永久链接至目标">¶</a></dt>
<dd><p>缺陷超胞自洽计算的顶级目录路径，其中包含不同带电情况自洽计算的子目录。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-CMPOT">
<span class="sig-name descname"><span class="pre">CMPOT</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-CMPOT" title="永久链接至目标">¶</a></dt>
<dd><p>增减原子的化学势 <span class="math notranslate nohighlight">\(\mu_i\)</span> （ <span class="math notranslate nohighlight">\(= \mu _i^\Theta + \Delta \mu _i\)</span> ），
以空格分隔，是一个包含偶数个值的序列，交替表示移除的加入的原子的化学势。
比如对于 Nb 被 Ta 取代（即移除 Nb 原子，加入 Ta 原子），则设置为：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CMPOT</span> <span class="o">=</span> <span class="n">mu_Nb</span> <span class="n">mu_Ta</span>
</pre></div>
</div>
<p>特别地，对于间隙和空位，可以认为同时地移除或者加入一个化学势为 0 的原子，
比如对于 Nb 空位缺陷：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CMPOT</span> <span class="o">=</span> <span class="n">mu_Nb</span> <span class="mi">0</span>
</pre></div>
</div>
<p>对于 Nb 间隙缺陷：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CMPOT</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">mu_Nb</span>
</pre></div>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-VALENCE">
<span class="sig-name descname"><span class="pre">VALENCE</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-VALENCE" title="永久链接至目标">¶</a></dt>
<dd><p>缺陷原子的电荷值，以空格分隔。注意，电子本身带负电，这意味着在 VASP
的 INCAR 文件中，增加 NELECT 值对应更负的电荷值。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-DDNAME">
<span class="sig-name descname"><span class="pre">DDNAME</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-DDNAME" title="永久链接至目标">¶</a></dt>
<dd><p>每个电荷值（<a class="reference internal" href="#cmdoption-arg-VALENCE"><code class="xref std std-option docutils literal notranslate"><span class="pre">VALENCE</span></code></a>）自洽计算的子目录名称，默认值为 <code class="docutils literal notranslate"><span class="pre">auto</span></code> ，
通过组合 <a class="reference internal" href="#cmdoption-arg-PREFIX"><code class="xref std std-option docutils literal notranslate"><span class="pre">PREFIX</span></code></a> 和 <a class="reference internal" href="#cmdoption-arg-VALENCE"><code class="xref std std-option docutils literal notranslate"><span class="pre">VALENCE</span></code></a> 自动生成，
这里价态会保留前置的“+/-”号。比如，如果 <a class="reference internal" href="#cmdoption-arg-VALENCE"><code class="xref std std-option docutils literal notranslate"><span class="pre">VALENCE</span> <span class="pre">=</span> <span class="pre">-1</span> <span class="pre">0</span> <span class="pre">1</span></code></a> ，
且 <a class="reference internal" href="#cmdoption-arg-PREFIX"><code class="xref std std-option docutils literal notranslate"><span class="pre">PREFIX</span> <span class="pre">=</span> <span class="pre">charge_</span></code></a> ，那么当 <a class="reference internal" href="#cmdoption-arg-DDNAME"><code class="xref std std-option docutils literal notranslate"><span class="pre">DDNAME</span> <span class="pre">=</span> <span class="pre">auto</span></code></a> 时，
等价于 <a class="reference internal" href="#cmdoption-arg-DDNAME"><code class="xref std std-option docutils literal notranslate"><span class="pre">DDNAME</span> <span class="pre">=</span> <span class="pre">charge_-1</span> <span class="pre">charge_0</span> <span class="pre">charge_+1</span></code></a> 。
或者，可以直接指定子目录名称，用空格分隔（目前不允许在子目录名称中含有空格）。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-DREFER">
<span class="sig-name descname"><span class="pre">DREFER</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-DREFER" title="永久链接至目标">¶</a></dt>
<dd><p>指定含有缺陷的超胞所在的目录，主要用于和完美晶胞对比确认缺陷位置。
默认值为 <code class="docutils literal notranslate"><span class="pre">auto</span></code> ，程序自动从 0 价缺陷目录中读取缺陷超胞结构。
如果提供，则程序会在 <a class="reference internal" href="#cmdoption-arg-DDNAME"><code class="xref std std-option docutils literal notranslate"><span class="pre">DDNAME</span></code></a> / <a class="reference internal" href="#cmdoption-arg-DREFER"><code class="xref std std-option docutils literal notranslate"><span class="pre">DREFER</span></code></a>
目录下寻找缺陷超胞的 POSCAR 文件。</p>
<div class="versionadded">
<p><span class="versionmodified added">在 0.3 版本加入: </span><a class="reference internal" href="#cmdoption-arg-DREFER"><code class="xref std std-option docutils literal notranslate"><span class="pre">DREFER</span></code></a> 参数。</p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-PREFIX">
<span class="sig-name descname"><span class="pre">PREFIX</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-PREFIX" title="永久链接至目标">¶</a></dt>
<dd><p>不同电荷值的自洽计算子目录的前缀，默认值为 <code class="docutils literal notranslate"><span class="pre">charge_</span></code> 。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-EVBM">
<span class="sig-name descname"><span class="pre">EVBM</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-EVBM" title="永久链接至目标">¶</a></dt>
<dd><p>价带顶能量。默认值为 <code class="docutils literal notranslate"><span class="pre">inf</span></code> ，程序自动从 <a class="reference internal" href="#cmdoption-arg-DDEFECT"><code class="xref std std-option docutils literal notranslate"><span class="pre">DDEFECT</span></code></a> 目录下的
EIGENVAL 文件读取。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-ECBM">
<span class="sig-name descname"><span class="pre">ECBM</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-ECBM" title="永久链接至目标">¶</a></dt>
<dd><p>导带底能量。默认值为 <code class="docutils literal notranslate"><span class="pre">inf</span></code> ，程序自动从 <a class="reference internal" href="#cmdoption-arg-DDEFECT"><code class="xref std std-option docutils literal notranslate"><span class="pre">DDEFECT</span></code></a> 目录下的
EIGENVAL 文件读取。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-PENERGY">
<span class="sig-name descname"><span class="pre">PENERGY</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-PENERGY" title="永久链接至目标">¶</a></dt>
<dd><p>完美晶胞的总能量。默认值为 <code class="docutils literal notranslate"><span class="pre">inf</span></code> ，程序自动从 <a class="reference internal" href="#cmdoption-arg-DPERFECT"><code class="xref std std-option docutils literal notranslate"><span class="pre">DPERFECT</span></code></a> 目录下的
OUTCAR 文件读取。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-PVOLUME">
<span class="sig-name descname"><span class="pre">PVOLUME</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-PVOLUME" title="永久链接至目标">¶</a></dt>
<dd><p>完美晶胞的体积。默认值为 <code class="docutils literal notranslate"><span class="pre">inf</span></code> ，程序自动从 <a class="reference internal" href="#cmdoption-arg-DPERFECT"><code class="xref std std-option docutils literal notranslate"><span class="pre">DPERFECT</span></code></a> 目录下的
OUTCAR 文件读取。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-EWALD">
<span class="sig-name descname"><span class="pre">EWALD</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-EWALD" title="永久链接至目标">¶</a></dt>
<dd><p>马德龙常数。默认值为 <code class="docutils literal notranslate"><span class="pre">0</span></code> ，表示禁用镜像电荷修正项。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-EPSILON">
<span class="sig-name descname"><span class="pre">EPSILON</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-EPSILON" title="永久链接至目标">¶</a></dt>
<dd><p>介电常数。默认值为 <code class="docutils literal notranslate"><span class="pre">inf</span></code> ，表示禁用镜像电荷修正项。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-ICCOEF">
<span class="sig-name descname"><span class="pre">ICCOEF</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-ICCOEF" title="永久链接至目标">¶</a></dt>
<dd><p>镜像电荷修正项可以改写为 <span class="math notranslate nohighlight">\(E _{\text{IC}} = C _{\text{IC}} \cdot q ^2\)</span>,
可以直接通过 ICCOEF 指定系数 <span class="math notranslate nohighlight">\(C _{\text{IC}}\)</span> 。默认值为 <code class="docutils literal notranslate"><span class="pre">inf</span></code> ,
由 <a class="reference internal" href="#cmdoption-arg-EPSILON"><code class="xref std std-option docutils literal notranslate"><span class="pre">EPSILON</span></code></a> 和 <a class="reference internal" href="#cmdoption-arg-EWALD"><code class="xref std std-option docutils literal notranslate"><span class="pre">EWALD</span></code></a> 自动计算，即：</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C _{\text{IC}} = \left[ 1 - \frac{1}{3} \left( 1-\frac{1}{\varepsilon} \right) \right]
          \frac{E _{\text{wald}}}{2 \varepsilon}\]</div>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-PADIFF">
<span class="sig-name descname"><span class="pre">PADIFF</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-PADIFF" title="永久链接至目标">¶</a></dt>
<dd><p>电势对齐修正项可以改写为 <span class="math notranslate nohighlight">\(E _{\text{PA}} = q \cdot \Delta V\)</span>,
可以直接通过 PADIFF （和 <a class="reference internal" href="#cmdoption-arg-VALENCE"><code class="xref std std-option docutils literal notranslate"><span class="pre">VALENCE</span></code></a> 长度相等的列表）指定电势差
<span class="math notranslate nohighlight">\(\Delta V\)</span> 。 默认值为 <code class="docutils literal notranslate"><span class="pre">[inf,</span> <span class="pre">...]</span></code>，自动读取 OUTCAR 文件中
距离缺陷最远位置处的电势差值。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-BFTYPE">
<span class="sig-name descname"><span class="pre">BFTYPE</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-BFTYPE" title="永久链接至目标">¶</a></dt>
<dd><p>能带填充修正机制的类型。默认值为 <code class="docutils literal notranslate"><span class="pre">0</span></code>，表示禁用能带填充修正项。
<code class="docutils literal notranslate"><span class="pre">1</span></code> 表示仅修正导带，<code class="docutils literal notranslate"><span class="pre">-1</span></code> 表示仅修正价带，<code class="docutils literal notranslate"><span class="pre">2</span></code> 表示同时修正导带和价带。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-EMIN">
<span class="sig-name descname"><span class="pre">EMIN</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-EMIN" title="永久链接至目标">¶</a></dt>
<dd><p>费米能级的下边界（以 <a class="reference internal" href="#cmdoption-arg-EVBM"><code class="xref std std-option docutils literal notranslate"><span class="pre">EVBM</span></code></a> 为基准），默认值为 <code class="docutils literal notranslate"><span class="pre">-1</span></code> 。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-EMAX">
<span class="sig-name descname"><span class="pre">EMAX</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-EMAX" title="永久链接至目标">¶</a></dt>
<dd><p>费米能级的上边界（以 <a class="reference internal" href="#cmdoption-arg-EVBM"><code class="xref std std-option docutils literal notranslate"><span class="pre">EVBM</span></code></a> 为基准），默认值为 <code class="docutils literal notranslate"><span class="pre">2</span></code> 。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-NPTS">
<span class="sig-name descname"><span class="pre">NPTS</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-NPTS" title="永久链接至目标">¶</a></dt>
<dd><p>费米能级采样点数，默认值为 <code class="docutils literal notranslate"><span class="pre">1001</span></code> 。</p>
</dd></dl>

</section>
<section id="edoping-log">
<h3>EDOPING.log<a class="headerlink" href="#edoping-log" title="此标题的永久链接">¶</a></h3>
<p><a class="reference internal" href="#cmdoption-arg-cal"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">cal</span></code></a> 命令的运行日志，和屏幕输出一样。</p>
</section>
<section id="edoping-dat">
<h3>EDOPING.dat<a class="headerlink" href="#edoping-dat" title="此标题的永久链接">¶</a></h3>
<p><a class="reference internal" href="#cmdoption-arg-cal"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">cal</span></code></a> 命令的计算结果文件，包含不同电荷值缺陷的形成能。
它包含 <code class="docutils literal notranslate"><span class="pre">Nq</span> <span class="pre">+</span> <span class="pre">3</span></code> 列，以空格分隔，第一列是费米能级（以 <a class="reference internal" href="#cmdoption-arg-EVBM"><code class="xref std std-option docutils literal notranslate"><span class="pre">EVBM</span></code></a> 为基准），
第二列是缺陷形成能，第三列是对应的电荷值，后面各列依次是不同电荷值的缺陷形成能。
第一行是注释行，包含列名称，最后两个值分别表示晶胞体积和简并因子。一个例子如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ef, Eformation, q , q_-3, q_-2, q_-1, q_+0, q_+1, q_+2, q_+3;    1689.3500    1</span>
<span class="o">-</span><span class="mf">1.0000</span> <span class="o">-</span><span class="mf">1.6816</span> <span class="mf">3.0000</span> <span class="mf">5.8115</span> <span class="mf">4.3378</span> <span class="mf">2.8985</span> <span class="mf">1.4866</span> <span class="mf">0.0987</span> <span class="o">-</span><span class="mf">0.8285</span> <span class="o">-</span><span class="mf">1.6816</span>
<span class="o">-</span><span class="mf">0.9990</span> <span class="o">-</span><span class="mf">1.6786</span> <span class="mf">3.0000</span> <span class="mf">5.8085</span> <span class="mf">4.3358</span> <span class="mf">2.8975</span> <span class="mf">1.4866</span> <span class="mf">0.0997</span> <span class="o">-</span><span class="mf">0.8265</span> <span class="o">-</span><span class="mf">1.6786</span>
<span class="o">-</span><span class="mf">0.9980</span> <span class="o">-</span><span class="mf">1.6756</span> <span class="mf">3.0000</span> <span class="mf">5.8055</span> <span class="mf">4.3338</span> <span class="mf">2.8965</span> <span class="mf">1.4866</span> <span class="mf">0.1007</span> <span class="o">-</span><span class="mf">0.8245</span> <span class="o">-</span><span class="mf">1.6756</span>
<span class="o">-</span><span class="mf">0.9970</span> <span class="o">-</span><span class="mf">1.6726</span> <span class="mf">3.0000</span> <span class="mf">5.8025</span> <span class="mf">4.3318</span> <span class="mf">2.8955</span> <span class="mf">1.4866</span> <span class="mf">0.1017</span> <span class="o">-</span><span class="mf">0.8225</span> <span class="o">-</span><span class="mf">1.6726</span>
<span class="o">-</span><span class="mf">0.9960</span> <span class="o">-</span><span class="mf">1.6696</span> <span class="mf">3.0000</span> <span class="mf">5.7995</span> <span class="mf">4.3298</span> <span class="mf">2.8945</span> <span class="mf">1.4866</span> <span class="mf">0.1027</span> <span class="o">-</span><span class="mf">0.8205</span> <span class="o">-</span><span class="mf">1.6696</span>
<span class="o">-</span><span class="mf">0.9950</span> <span class="o">-</span><span class="mf">1.6666</span> <span class="mf">3.0000</span> <span class="mf">5.7965</span> <span class="mf">4.3278</span> <span class="mf">2.8935</span> <span class="mf">1.4866</span> <span class="mf">0.1037</span> <span class="o">-</span><span class="mf">0.8185</span> <span class="o">-</span><span class="mf">1.6666</span>
<span class="o">-</span><span class="mf">0.9940</span> <span class="o">-</span><span class="mf">1.6636</span> <span class="mf">3.0000</span> <span class="mf">5.7935</span> <span class="mf">4.3258</span> <span class="mf">2.8925</span> <span class="mf">1.4866</span> <span class="mf">0.1047</span> <span class="o">-</span><span class="mf">0.8165</span> <span class="o">-</span><span class="mf">1.6636</span>
<span class="o">-</span><span class="mf">0.9930</span> <span class="o">-</span><span class="mf">1.6606</span> <span class="mf">3.0000</span> <span class="mf">5.7905</span> <span class="mf">4.3238</span> <span class="mf">2.8915</span> <span class="mf">1.4866</span> <span class="mf">0.1057</span> <span class="o">-</span><span class="mf">0.8145</span> <span class="o">-</span><span class="mf">1.6606</span>
<span class="o">-</span><span class="mf">0.9920</span> <span class="o">-</span><span class="mf">1.6576</span> <span class="mf">3.0000</span> <span class="mf">5.7875</span> <span class="mf">4.3218</span> <span class="mf">2.8905</span> <span class="mf">1.4866</span> <span class="mf">0.1067</span> <span class="o">-</span><span class="mf">0.8125</span> <span class="o">-</span><span class="mf">1.6576</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
<section id="edoping-cmpot">
<h3>EDOPING.cmpot<a class="headerlink" href="#edoping-cmpot" title="此标题的永久链接">¶</a></h3>
<p><a class="reference internal" href="#cmdoption-arg-chempot"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">chempot</span></code></a> 命令的输入文件，用于指定化合物的配比和形成能。
以下面的 Mn 掺杂 NbFeSb 体系为例解释文件格式：
第一行以 <code class="docutils literal notranslate"><span class="pre">#</span></code> 号开始，包含体系的元素名称。
第二行是目标化合物 NbFeSb 的配比及形成能，
然后是所有考虑的竞争相的元素配比及形成能。
关于元素配比和形成能归一化的问题，
详见 <a class="reference internal" href="#cmdoption-arg-chempot"><code class="xref std std-option docutils literal notranslate"><span class="pre">edp</span> <span class="pre">chempot</span></code></a> 命令。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nb   Fe   Sb   Mn</span>
 <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="o">-</span><span class="mf">0.350468735</span>
 <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mf">0.0</span>
 <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="o">-</span><span class="mf">1.9464166666871563e-05</span>
 <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">0</span>  <span class="o">-</span><span class="mf">0.03650248166666733</span>
 <span class="mi">3</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="o">-</span><span class="mf">0.28675903625</span>
 <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">2</span>  <span class="mi">0</span>  <span class="o">-</span><span class="mf">0.279502903333333</span>
 <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">2</span>  <span class="o">-</span><span class="mf">0.1441571941954</span>
 <span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="id14">
<h2>文章引用<a class="headerlink" href="#id14" title="此标题的永久链接">¶</a></h2>
<p><strong>如果此软件以及文档给您的工作提供了帮助，
请引用我们的文章，这对我们很重要，非常感谢！</strong></p>
<p>[1] J. Zhu, J. Li, Z. Ti, L. Wang, Y. Shen, L. Wei, X. Liu, X. Chen, P. Liu,
J. Sui, Y. Zhang, eDoping: A high-throughput software package for evaluating
point defect doping limits in semiconductor and insulator materials,
<em>Materials Today Physics</em>, 55 (2025) 101754,
<a class="reference external" href="https://doi.org/10.1016/j.mtphys.2025.101754">https://doi.org/10.1016/j.mtphys.2025.101754</a>.</p>
<p>[2] J. Li, J. Zhu, Z. Ti, W. Zhai, L. Wei, C. Zhang, P. Liu, Y. Zhang,
Synergistic defect engineering for improving n-type NbFeSb thermoelectric
performance through high-throughput computations,
<em>Journal of Materials Chemistry A</em>, 10 (46) (2022) 24598-24610,
<a class="reference external" href="https://doi.org/10.1039/d2ta07142h">https://doi.org/10.1039/d2ta07142h</a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="zintl.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">eDoping 学习分享</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023-2025, Jianbo Zhu, Jingyu Li, Peng-Fei Liu
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">eDoping 手册</a><ul>
<li><a class="reference internal" href="#id1">主要功能</a></li>
<li><a class="reference internal" href="#id2">程序安装</a></li>
<li><a class="reference internal" href="#id3">快速开始</a><ul>
<li><a class="reference internal" href="#id4">文件结构</a></li>
<li><a class="reference internal" href="#id5">能量计算</a></li>
<li><a class="reference internal" href="#id6">化学势计算</a></li>
<li><a class="reference internal" href="#id7">修正项</a></li>
<li><a class="reference internal" href="#id8">后处理</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9">点缺陷形成能计算</a><ul>
<li><a class="reference internal" href="#id10">缺陷晶胞构建与体系能量计算</a></li>
<li><a class="reference internal" href="#id11">化学势计算与数据库使用</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id12">命令行使用参考</a></li>
<li><a class="reference internal" href="#id13">输入/输出文件</a><ul>
<li><a class="reference internal" href="#edoping-in">EDOPING.in</a></li>
<li><a class="reference internal" href="#edoping-log">EDOPING.log</a></li>
<li><a class="reference internal" href="#edoping-dat">EDOPING.dat</a></li>
<li><a class="reference internal" href="#edoping-cmpot">EDOPING.cmpot</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id14">文章引用</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=64ea29b8"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/translations.js?v=beaddf03"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>